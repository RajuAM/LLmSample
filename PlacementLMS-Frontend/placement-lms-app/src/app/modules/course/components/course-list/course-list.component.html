<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <h2>Available Courses</h2>
    </div>
  </div>

  <!-- Search and Filter Section -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="input-group">
        <input
          type="text"
          class="form-control"
          placeholder="Search courses..."
          [(ngModel)]="searchTerm"
          (keyup.enter)="onSearch()">
        <button class="btn btn-outline-secondary" type="button" (click)="onSearch()">
          <i class="fas fa-search"></i>
        </button>
      </div>
    </div>
    <div class="col-md-6">
      <div class="d-flex justify-content-end">
        <div class="btn-group" role="group">
          <button
            type="button"
            class="btn"
            [class.btn-primary]="selectedCategory === 'All'"
            [class.btn-outline-primary]="selectedCategory !== 'All'"
            (click)="filterByCategory('All')">
            All
          </button>
          <button
            type="button"
            class="btn"
            [class.btn-primary]="selectedCategory === 'Technical'"
            [class.btn-outline-primary]="selectedCategory !== 'Technical'"
            (click)="filterByCategory('Technical')">
            Technical
          </button>
          <button
            type="button"
            class="btn"
            [class.btn-primary]="selectedCategory === 'Soft Skills'"
            [class.btn-outline-primary]="selectedCategory !== 'Soft Skills'"
            (click)="filterByCategory('Soft Skills')">
            Soft Skills
          </button>
          <button
            type="button"
            class="btn"
            [class.btn-primary]="selectedCategory === 'Domain-specific'"
            [class.btn-outline-primary]="selectedCategory !== 'Domain-specific'"
            (click)="filterByCategory('Domain-specific')">
            Domain-specific
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="row">
    <div class="col-12 text-center">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  </div>

  <!-- Course Cards -->
  <div class="row" *ngIf="!isLoading">
    <div class="col-md-4 mb-4" *ngFor="let course of filteredCourses">
      <div class="card h-100">
        <img
          *ngIf="course.thumbnailImagePath"
          [src]="course.thumbnailImagePath"
          class="card-img-top"
          alt="{{course.title}}"
          style="height: 200px; object-fit: cover;">

        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{course.title}}</h5>
          <p class="card-text flex-grow-1">{{course.description | slice:0:100}}...</p>

          <div class="mb-2">
            <span class="badge bg-primary">{{course.category}}</span>
            <small class="text-muted d-block">{{course.institutionName}}</small>
          </div>

          <div class="mb-2">
            <div class="d-flex justify-content-between align-items-center">
              <span *ngIf="course.discountPrice > 0" class="text-decoration-line-through text-muted">
                ₹{{course.price}}
              </span>
              <span class="fw-bold fs-5">
                ₹{{course.discountPrice > 0 ? course.discountPrice : course.price}}
              </span>
            </div>
          </div>

          <div class="mb-2">
            <small class="text-muted">
              <i class="fas fa-clock"></i> {{course.durationHours}} hours
            </small>
            <small class="text-muted d-block">
              <i class="fas fa-users"></i> {{course.enrollmentCount}} enrolled
            </small>
          </div>

          <div class="mt-auto">
            <button
              class="btn btn-primary me-2"
              (click)="viewCourseDetails(course.id)">
              View Details
            </button>
            <button
              class="btn btn-success"
              (click)="enrollInCourse(course.id)">
              Enroll Now
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Courses Found -->
  <div class="row" *ngIf="!isLoading && filteredCourses.length === 0">
    <div class="col-12 text-center">
      <p class="text-muted">No courses found matching your criteria.</p>
    </div>
  </div>
</div>